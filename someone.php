<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <!-- Font Text -->
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@700&display=swap" rel="stylesheet">
    <link rel="icon" href="data:image/png;base64,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" type="image/png">

    <title>Tiarakuy‚ù§</title>
  </head>

    <style>
        /* Import Google font - Poppins */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Poppins", sans-serif;
        }
        body {
            background: #E3F2FD;
        }
        .chatbot {
            position: fixed;
            background: #fff;
            border-radius: 15px;
            overflow: hidden;
            opacity: 1;
            pointer-events: auto;
            transform: scale(1);
            transform-origin: bottom right;
            box-shadow: 0 0 128px 0 rgba(0,0,0,0.1),
                        0 32px 64px -48px rgba(0,0,0,0.5);
            transition: all 0.1s ease;
        }

        .chatbot .chatbox {
            overflow-y: auto;
        }
        .chatbot :where(.chatbox, textarea)::-webkit-scrollbar {
            width: 6px;
        }
        .chatbot :where(.chatbox, textarea)::-webkit-scrollbar-track {
            background: #fff;
            border-radius: 25px;
        }
        .chatbot :where(.chatbox, textarea)::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 25px;
        }
        .chatbox .chat {
            display: flex;
            list-style: none;
        }
        .chatbox .outgoing {
            margin: 20px 0;
            justify-content: flex-end;
        }
        .chatbox .incoming span {
            width: 32px;
            height: 32px;
            color: #fff;
            cursor: default;
            text-align: center;
            line-height: 32px;
            align-self: flex-end;
            background: #6d6d6d;
            border-radius: 4px;
            margin: 0 10px 7px 0;
        }
        
        .chatbox .chat p {
            white-space: pre-wrap;
            padding: 12px 16px;
            border-radius: 10px 10px 0 10px;
            max-width: 100%;
            color: #fff;
            font-size: 0.95rem;
            background: #6d6d6d;
        }
        .chatbox .incoming p {
            border-radius: 10px 10px 10px 0px;
        }
        .chatbox .incoming p {
            color: #000;
            background: #f2f2f2;
        }
        .chatbox .incoming img {
            color: #000;
            background: #f2f2f2;
        }
        .chatbox .incoming img {
            border-radius: 10px 10px 10px 0px;
            padding: 20px;
        }
        .chatbox .incoming audio {
            color: #000;
            background: #f2f2f2;
        }
        .chatbox .incoming .img-audio {
            border-radius: 10px 10px 0px 0px;
        }
        .chatbox .incoming audio {
            border-radius: 0px 0px 10px 0px;
            width: 40%;
        }
        .chatbot .chat-input {
            display: flex;
            gap: 5px;
            position: absolute;
            bottom: 0;
            width: 100%;
            background: #fff;
            border-top: 1px solid #ddd;
        }
        .chat-input textarea {
            height: 55px;
            width: 100%;
            border: none;
            outline: none;
            resize: none;
            max-height: 180px;
            padding: 15px 15px 15px 0;
            font-size: 0.95rem;
        }
        .chat-input span {
            align-self: flex-end;
            color: #6d6d6d;
            cursor: pointer;
            height: 55px;
            display: flex;
            align-items: center;
            visibility: hidden;
            font-size: 1.35rem;
        }
        .chat-input textarea:valid ~ span {
            visibility: visible;
        }
        .chatbot {
            right: 0;
            bottom: 0;
            height: 100%;
            border-radius: 0;
            width: 100%;
        }
        .chatbot .chatbox {
            height: 90%;
            padding: 25px 15px 100px;
        }
        .chatbot .chat-input {
            padding: 5px 15px;
        }
        .send{
            border-radius: 100px;
        }
        .chatbox .chat img{
            width: 40%;
        }
  </style>

  <body>
    <!-- navbar -->

    <!-- chat -->
      <div class="chatbot">
          <!-- navbar -->
     <?php require('template/navbar.php'); ?>
    <!-- navbar -->
        <ul class="chatbox">
          <li class="chat incoming">
            <span class="">üñ§</span>
            <p>Info‚Äº<br>Chat anda 100% amanüîí<br>Fitur kecerdasan buatan</p>
          </li>
        </ul>
        <div class="chat-input">
          <textarea placeholder="Enter a message..." spellcheck="false" required></textarea>
          <button class="send-chat-btn btn btn-dark send">üì®</button>
        </div>
      </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="src/axios.min.js"></script>
    <script src="telgram.js" ></script>  
    <script type="importmap">
        {
          "imports": {
            "@google/generative-ai": "https://esm.run/@google/generative-ai"
          }
        }
      </script>
    <!-- <script src="src/chat.js"></script> -->
    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";
        const chatbox = document.querySelector(".chatbox");
        const chatInput = document.querySelector(".chat-input textarea");
        // const sendChatBtn = document.querySelector(".chat-input span");

        let userMessage = null; // Variable to store user's message
        const inputInitHeight = chatInput.scrollHeight;

        const createChatLi = (message, className) => {
            // Create a chat <li> element with passed message and className
            const chatLi = document.createElement("li");
            chatLi.classList.add("chat", `${className}`);
            let chatContent = className === "outgoing" ? `<p></p>` : `<span class="">üñ§</span><p></p>`;
            chatLi.innerHTML = chatContent;
            chatLi.querySelector("p").textContent = message;
            return chatLi; // return chat <li> element
        }

        let thinkingLi; // Declare the variable outside the functions to make it accessible globally

        const generateResponse = (chatElement, responseText) => {
            // Buat elemen baru untuk respons aktual
            const responseLi = createChatLi(responseText, "incoming");

            if (chatElement) {
                const parent = chatElement.parentElement; // Dapatkan elemen parent (responseLi)
                parent.replaceChild(responseLi, chatElement);

                setTimeout(() => {
                    parent.removeChild(responseLi);
                    chatbox.scrollTo(0, chatbox.scrollHeight);
                }, 1000); // Sesuaikan durasi yang diinginkan
            } else {
                // Jika chatElement tidak ada, tambahkan respons langsung
                chatbox.appendChild(thinkingLi);
                chatbox.scrollTo(0, chatbox.scrollHeight);
            }
        }

        const handleChat = () => {
            userMessage = chatInput.value.trim();
            if (!userMessage) return;

            chatInput.value = "";
            chatInput.style.height = `${inputInitHeight}px`;

            const outgoingChatLi = createChatLi(userMessage, "outgoing");
            chatbox.appendChild(outgoingChatLi);
            chatbox.scrollTo(0, chatbox.scrollHeight);

            // Kirim pesan ke Telegram setelah pengguna mengirim pesan
            const pesan = `[Pesan Terkirim] ${nama} : ${userMessage}`;
            kirimPesanTelegram(pesan);

            if (userMessage.toLowerCase() === "/menu" || userMessage.toLowerCase() === "/list" ) {
const bot = createChatLi(
`List Perintah Bot
/gambar [Random]
/musik [Random]
Chat Bot Ini Dalam Pengembangan`, "incoming");
chatbox.appendChild(bot);
chatbox.scrollTo(0, chatbox.scrollHeight);
            } else if(userMessage.toLowerCase() === "/gambar"){
                const imageUrls = [
                    "https://cdn-icons-png.flaticon.com/512/4712/4712109.png",

                ];

                const randomImageUrl = imageUrls[Math.floor(Math.random() * imageUrls.length)];
                
                const imageLi = document.createElement("li");
                imageLi.classList.add("chat", "incoming");
                imageLi.innerHTML = `<img src="${randomImageUrl}" alt="Image"/>`;
                chatbox.appendChild(imageLi);
                chatbox.scrollTo(0, chatbox.scrollHeight);

            }else if(userMessage.toLowerCase() === "/musik"){
            
            const audioUrls = [
                {
                    "title": "Death Bed",
                    "artist": "Powfu",
                    "artwork": "https://samplesongs.netlify.app/album-arts/death-bed.jpg",
                    "url": "https://samplesongs.netlify.app/Death%20Bed.mp3",
                    "id": "1"
                },
                {
                    "title": "Bad Liar",
                    "artist": "Imagine Dragons",
                    "artwork": "https://samplesongs.netlify.app/album-arts/bad-liar.jpg",
                    "url": "https://samplesongs.netlify.app/Bad%20Liar.mp3",
                    "id": "2"
                },
                {
                    "title": "Faded",
                    "artist": "Alan Walker",
                    "artwork": "https://samplesongs.netlify.app/album-arts/faded.jpg",
                    "url": "https://samplesongs.netlify.app/Faded.mp3",
                    "id": "3"
                },
                {
                    "title": "Hate Me",
                    "artist": "Ellie Goulding",
                    "artwork": "https://samplesongs.netlify.app/album-arts/hate-me.jpg",
                    "url": "https://samplesongs.netlify.app/Hate%20Me.mp3",
                    "id": "4"
                },
                {
                    "title": "Solo",
                    "artist": "Clean Bandit",
                    "artwork": "https://samplesongs.netlify.app/album-arts/solo.jpg",
                    "url": "https://samplesongs.netlify.app/Solo.mp3",
                    "id": "5"
                },
                {
                    "title": "Without Me",
                    "artist": "Halsey",
                    "artwork": "https://samplesongs.netlify.app/album-arts/without-me.jpg",
                    "url": "https://samplesongs.netlify.app/Without%20Me.mp3",
                    "id": "6"
                }

            ];

            const randomAudio = audioUrls[Math.floor(Math.random() * audioUrls.length)];

            const title = randomAudio.title;
            const artist = randomAudio.artist;
            const artwork = randomAudio.artwork;
            const audioUrl = randomAudio.url;
            const id = randomAudio.id;
            
            console.log("Title:", title);
            console.log("Artist:", artist);
            console.log("Artwork:", artwork);
            console.log("Audio URL:", audioUrl);
            console.log("ID:", id);
            
            const audioLi = document.createElement("li");
            const imageLi = document.createElement("li");
            audioLi.classList.add("chat", "incoming");
            imageLi.classList.add("chat", "incoming");
            imageLi.innerHTML = `<img class="img-audio" src="${artwork}" alt="Image"/>`;
            audioLi.innerHTML = `<audio controls><source src="${audioUrl}" type="audio/mp3"></audio>`;
            chatbox.appendChild(imageLi);
            chatbox.appendChild(audioLi);
            chatbox.scrollTo(0, chatbox.scrollHeight);
            }else {
                const API_KEY = "AIzaSyA4kp656ozNAJiy85bc4aNmBbtEnQtPusg";  
                const genAI = new GoogleGenerativeAI(API_KEY);
               // const generationConfig = {
                  //  stopSequences: ["red"],
                  //  maxOutputTokens: 200,
                   // temperature: 0.9,
                  //  topP: 0.1,
                  //  topK: 16,
                 // };
                  //temperature: 0.9,
                 // topK: 1,
                 // topP: 1,
                 // maxOutputTokens: 2048,

                async function run() {
                const model = genAI.getGenerativeModel({ model: "gemini-pro"});
                const prompt = `${userMessage}`;
                const result = await model.generateContent(prompt);
                //const { totalTokens } = await model.countTokens(prompt);
                const response = await result.response;
                const text = response.text();
                const ai = createChatLi(`${text}`, "incoming");
                chatbox.appendChild(ai);
                chatbox.scrollTo(0, chatbox.scrollHeight); 
                const pesan = `[Balasan AI] BOT AI : ${text}`;
                kirimPesanTelegram(pesan);
                speakText(text);           
                }
                run();
            }
            
        }

        function speakText(text) {
            if ('speechSynthesis' in window) {
                var synth = window.speechSynthesis;
                var utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'id-ID'; // Sesuaikan dengan kode bahasa yang diinginkan
                synth.speak(utterance);
            } else {
                console.error('Browser tidak mendukung Web Speech API');
            }
        }

        const hapusChat = () => {
            userMessage = chatInput.value.trim();
            if (!userMessage) return;

            var pesan = `[Pesan Dihapus] ${nama} : ${userMessage}`;
            kirimPesanTelegram(pesan);
        }

        let backspacePressed = false;
        let backspaceHoldTimer;

        chatInput.addEventListener('keydown', function(event) {
            if (event.key === "Backspace" && !backspacePressed) {
                backspacePressed = true;

                // Set a timer to execute the function after a certain duration (e.g., 1000 milliseconds or 1 second)
                backspaceHoldTimer = setTimeout(() => {
                    hapusChat();
                }, 400);
            }
        });

        chatInput.addEventListener("keyup", (e) => {
            if (e.key === "Backspace") {
                backspacePressed = false;
                // Clear the timer when the key is released before the timeout duration
                clearTimeout(backspaceHoldTimer);
            }
        });

        chatInput.addEventListener("keydown", (e) => {
            // If Enter key is pressed without Shift key and the window 
            // width is greater than 800px, handle the chat
            if (e.key === "Enter" && !e.shiftKey && window.innerWidth > 800) {
                e.preventDefault();
                handleChat();
            }
        });

        document.addEventListener("DOMContentLoaded", function() {
            var sendChatBtn = document.querySelector(".send-chat-btn");
            sendChatBtn.addEventListener("click", handleChat);
            
        });
        // sendChatBtn.addEventListener("click", handleChat);

        const listenToTelegramMessages = async () => {
            let lastReceivedMessageId = 0;

            const telegramAPI = `https://api.telegram.org/bot6940826614:AAF-aZ-87ar55WzKoJtDb5hP27Dt60mQr5w/getUpdates`;

            while (true) {
                try {
                    const response = await axios.get(`${telegramAPI}?offset=${lastReceivedMessageId + 1}`);
                    const messages = response.data.result;

                    for (const message of messages) {
                        const chatId = message.message.chat.id;
                        const incomingMessage = message.message.text;

                        lastReceivedMessageId = message.update_id;

                        const incomingChatLi = createChatLi(incomingMessage, "incoming");
                        chatbox.appendChild(incomingChatLi);
                        chatbox.scrollTo(0, chatbox.scrollHeight);

                    }
                    // Tunggu sebelum mengirim permintaan lagi
                    await new Promise(resolve => setTimeout(resolve, 1000));
                } catch (error) {
                    console.error(error);
                }
            }
        };

        listenToTelegramMessages();

    </script>
    <script src="src/tanyakan.js"></script>
   
</body>
</html>